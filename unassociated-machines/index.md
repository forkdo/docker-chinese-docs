# 管理未关联的机器

<div class="px-4 border-l-2 border-l-magenta-light dark:border-l-magenta-dark">
  <p class="not-prose flex gap-2 items-center text-magenta-light dark:text-magenta-dark">
    <span class="icon-svg pb-1">
      <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 -960 960 960"><path d="M263-465q26-69 64.5-130.5T415-712l-77-15q-20-4-39.5 2T265-705L129-568q-11 11-8 26.5t17 21.5l125 55Zm580-398q-109-8-206.5 37.5T461-702q-50 50-88.5 106.5T309-473q-4 10-4 20t8 18l135 135q8 8 18 8t20-4q66-24 122.5-63T715-448q78-78 124-175.5T877-830q-1-6-3.5-11.5T866-852q-5-5-10.5-7.5T843-863ZM586-573q-20-20-20-49.5t20-49.5q20-20 49.5-20t49.5 20q20 20 20 49.5T685-573q-20 20-49.5 20T586-573ZM479-250l54 125q6 15 22 17.5t27-8.5l136-136q14-14 20-33.5t2-39.5l-14-77q-55 49-116.5 87.5T479-250Zm-317-68q35-35 85-35.5t85 34.5q35 35 35 85t-35 85q-48 48-113.5 57T87-74q9-66 18.5-131.5T162-318Z"/></svg>
    </span>
    <strong>关于未关联的机器</strong>
  </p>
  
未关联的机器是一项私有功能，可能并非对所有账户都可用。

</div>


Docker 管理员可以识别、查看和管理可能属于其组织但当前未链接到用户账户的 Docker Desktop 机器。此自助服务功能可帮助您了解整个组织中 Docker Desktop 的使用情况，并简化用户入职流程，无需 IT 人员介入。

## 先决条件

- Docker Business 或 Team 订阅
- 对 Docker 组织的组织所有者访问权限

## 关于未关联的机器

未关联的机器是 Docker 已识别为可能属于您的组织的 Docker Desktop 实例，但用户未使用属于您组织的账户登录 Docker Desktop。

## Docker 如何识别未关联的机器

Docker 使用遥测数据来识别哪些机器可能属于您的组织：

- 域名匹配：使用与您的组织关联的电子邮件域名登录的用户
- 注册表模式：分析容器注册表访问模式，以指示组织使用情况

## 查看未关联的机器

要查看有关未关联机器的详细信息：

1. 登录 [管理控制台](https://app.docker.com/admin) 并选择您的组织。
1. 在**用户管理**中，选择**未关联**。

机器列表显示：

- 机器 ID（Docker 生成的标识符）
- 用于预测用户是否属于您组织的注册表地址
- 用户电子邮件（仅在用户使用 Docker Desktop 时登录的情况下显示）
- Docker Desktop 版本
- 操作系统 (OS)
- 最后活动日期
- 登录强制状态

您可以：

- 将列表导出为 CSV
- 对单个或多个机器执行操作

## 为未关联的机器启用登录强制

> [!NOTE]
>
> 未关联机器的登录强制不同于通过 `registry.json` 和配置配置文件提供的[组织级登录强制](/enterprise/security/enforce-sign-in/)。此登录强制仅要求用户登录，以便管理员可以识别谁在使用机器，这意味着用户可以使用任何电子邮件地址登录。对于更严格的安全控制，将登录限制为已属于您组织的用户，请参阅[强制登录](/enterprise/security/enforce-sign-in/)。

登录强制可帮助您识别谁在您组织中使用未关联的机器。启用强制后，这些机器上的用户将需要登录 Docker Desktop。一旦他们登录，他们的电子邮件地址将出现在“未关联”列表中，然后您可以将他们添加到您的组织中。

您可以使用两种方法启用登录强制：

- 为您的组织中的所有未关联机器
- 为单个未关联机器

> [!IMPORTANT]
>
> 登录强制仅在 Docker Desktop 重启后生效。用户可以继续使用 Docker Desktop，直到下次重启。

### 为所有未关联机器启用登录强制

要为所有未关联机器启用登录强制：

1. 登录 [管理控制台](https://app.docker.com/admin) 并选择您的组织。
1. 在**用户管理**中，选择**未关联**。
1. 打开**强制登录**切换开关。
1. 在弹出模态框中，选择**要求登录**以确认。

所有未关联机器的**登录要求**状态将更新为**是**。

> [!NOTE]
>
> 当您为所有未关联机器启用登录强制时，将来检测到的任何新机器将自动启用登录强制。登录强制需要 Docker Desktop 版本 4.41 或更高版本。使用旧版本的用户不会被提示登录，可以继续使用 Docker Desktop，直到他们更新。在更新到版本 4.41 或更高版本之前，他们的状态显示为**待定**。

### 为单个未关联机器启用登录强制

要为单个未关联机器启用登录强制：

1. 登录 [管理控制台](https://app.docker.com/admin) 并选择您的组织。
1. 在**用户管理**中，选择**未关联**。
1. 找到您要为其启用登录强制的机器。
1. 选择**操作**菜单，然后选择**打开登录强制**。
1. 在弹出模态框中，选择**要求登录**以确认。

单个机器的**登录要求**状态将更新为**是**。

> [!NOTE]
>
> 登录强制需要 Docker Desktop 版本 4.41 或更高版本。使用旧版本的用户不会被提示登录，可以继续使用 Docker Desktop，直到他们更新。在更新到版本 4.41 或更高版本之前，他们的状态显示为**待定**。

### 用户登录时会发生什么

在您启用登录强制后：

1. 用户必须重启 Docker Desktop。强制仅在重启后生效。
1. 当用户打开 Docker Desktop 时，他们会看到登录提示。他们必须登录才能继续使用 Docker Desktop。
1. 用户电子邮件地址将出现在**未关联**列表中。
1. 您可以将用户添加到您的组织。

用户可以在登录后立即继续使用 Docker Desktop，即使在添加到您的组织之前也是如此。

## 将未关联的机器添加到您的组织

当您的组织中的用户在不登录的情况下使用 Docker 时，他们的机器将出现在**未关联**列表中。您可以通过两种方式将这些用户添加到您的组织：

- 自动添加：
    - 自动配置：如果您已启用自动配置的已验证域名，则使用匹配的电子邮件域名登录的用户将自动添加到您的组织。有关验证域名和自动配置的更多信息，请参阅[域名管理](/manuals/enterprise/security/domain-management.md)。
    - SSO 用户配置：如果您已配置 SSO 并启用了[即时配置](/manuals/enterprise/security/provisioning/just-in-time.md)，则通过您的 SSO 连接登录的用户将自动添加到您的组织。
- 手动添加：如果您没有设置自动配置或 SSO，或者用户的电子邮件域名与您的配置域名不匹配，则他们的电子邮件将出现在**未关联**列表中，您可以选择直接添加他们。

> [!NOTE]
>
> 如果您添加用户但没有足够的席位，将出现一个弹出窗口，提示您**获取更多席位**。

### 添加单个用户

1. 登录 [管理控制台](https://app.docker.com/admin) 并选择您的组织。
1. 在**用户管理**中，选择**未关联**。
1. 找到您要添加到组织的机器。
1. 选择**操作**菜单，然后选择**添加到组织**。
1. 在弹出模态框中，选择**添加用户**。

### 批量添加用户

1. 登录 [管理控制台](https://app.docker.com/admin) 并选择您的组织。
1. 在**用户管理**中，选择**未关联**。
1. 使用**复选框**选择您要添加到组织的机器。
1. 选择**添加到组织**按钮。
1. 在弹出模态框中，选择**添加用户**以确认。

## 禁用登录强制

### 为所有未关联机器禁用

1. 登录 [管理控制台](https://app.docker.com/admin) 并选择您的组织。
1. 在**用户管理**中，选择**未关联**。
1. 关闭**强制登录**切换开关。
1. 在弹出模态框中，选择**关闭登录要求**以确认。

所有未关联机器的**登录要求**状态将更新为**否**。

### 为特定未关联机器禁用

1. 登录 [管理控制台](https://app.docker.com/admin) 并选择您的组织。
1. 在**用户管理**中，选择**未关联**。
1. 找到您要为其禁用登录强制的机器。
1. 选择**操作**菜单，然后选择**关闭登录强制**。
1. 在弹出模态框中，选择**关闭登录要求**以确认。

单个机器的**登录要求**状态将更新为**否**。

