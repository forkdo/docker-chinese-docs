---
title: Docker Engine 18.09 发布说明
linkTitle: Engine v18.09
toc_min: 1
toc_max: 2
---

> **注意：**
>
> 从本次发布开始，守护进程、客户端和容器运行时现在被分装在独立的包中。
> 更新时，您需要同时更新所有包，以获取每个组件的最新补丁版本。
> 例如，在 Ubuntu 上：
> 
> ```console
> $ sudo apt-get install docker-ce docker-ce-cli containerd.io
> ```
> 
> 详情请参阅对应 Linux 发行版的[安装说明](../install/_index.md)。

## 18.09.9
2019-09-03

### 客户端

* 修复 Windows 路径检测在非 Windows 系统上的问题。[docker/cli#1990](https://github.com/docker/cli/pull/1990)
* 修复 Windows 上 Docker 拒绝从 delegation.key 加载密钥的问题。[docker/cli#1968](https://github.com/docker/cli/pull/1968)
* 更新了 bash 和 zsh 的补全脚本。

### 日志

* 修复读取 journald 日志的问题。[moby/moby#37819](https://github.com/moby/moby/pull/37819) [moby/moby#38859](https://github.com/moby/moby/pull/38859)

### 网络

* 防止在容器禁用网络时附加到网络导致的 panic。[moby/moby#39589](https://github.com/moby/moby/pull/39589)
* 修复服务端口在应用中随机不可用的问题。[docker/libnetwork#2069](https://github.com/docker/libnetwork/pull/2069)
* 修复清理 `--config-only` 网络和已优雅退出的 `--config-from` 网络的问题。[docker/libnetwork#2373](https://github.com/docker/libnetwork/pull/2373)

### 运行时

* 更新到 Go 1.11.13。
* 修复在使用 XFS 磁盘配额时 Docker Engine 可能出现的 panic。[moby/moby#39644](https://github.com/moby/moby/pull/39644)

### Swarm

* 修复 "grpc: received message larger than max" 错误。[moby/moby#39306](https://github.com/moby/moby/pull/39306)
* 修复节点上多个任务无法被移除的问题。[docker/swarmkit#2867](https://github.com/docker/swarmkit/pull/2867)

## 18.09.8
2019-07-17

### 运行时

* 在 Docker Engine 以调试模式运行时，对日志文件中更新的密钥进行了脱敏处理。[CVE-2019-13509](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-13509)：如果 Docker Engine 以调试模式运行，并使用 `docker stack deploy` 重新部署包含非外部密钥的堆栈，日志中将包含该密钥。

### 客户端

* 修复了 `parallelism` 和 `max_failure_ratio` 字段的回滚配置类型插值问题。

### 已知问题

* 升级过程有重要变更，如果未正确遵循，可能影响 Swarm 上运行应用的可用性。这些约束影响从任何早于 18.09 的版本升级到 18.09 或更高版本的情况。

## 18.09.7
2019-06-27

### 构建器

* 修复构建仅包含注释的 Dockerfile 时的 panic 错误。[moby/moby#38487](https://github.com/moby/moby/pull/38487)
* 添加了 GCR 认证问题的临时修复。[moby/moby#38246](https://github.com/moby/moby/pull/38246)
* 构建器-next：修复了 GCR token 缓存实现临时修复中的 bug。[moby/moby#39183](https://github.com/moby/moby/pull/39183)

### 网络

* 修复 `--network-rm` 无法移除网络的错误。[moby/moby#39174](https://github.com/moby/moby/pull/39174)

### 运行时

* 添加了 aufs 和层存储的性能优化，有助于大规模并行创建和删除容器。[moby/moby#39107](https://github.com/moby/moby/pull/39107)、[moby/moby#39135](https://github.com/moby/moby/pull/39135)
* 将 containerd 更新到版本 1.2.6。[moby/moby#39016](https://github.com/moby/moby/pull/39016)
* 修复 [CVE-2018-15664](https://nvd.nist.gov/vuln/detail/CVE-2018-15664) 符号链接交换攻击和目录遍历。[moby/moby#39357](https://github.com/moby/moby/pull/39357)
* Windows：修复 `docker service create --limit-cpu` 的支持。[moby/moby#39190](https://github.com/moby/moby/pull/39190)
* 守护进程：修复了镜像仓库验证问题。[moby/moby#38991](https://github.com/moby/moby/pull/38991)
* Docker 不再支持 ID 映射中 UID 和 GID 范围的排序。[moby/moby#39288](https://github.com/moby/moby/pull/39288)

### 日志

* 添加修复，现在允许日志插件处理大日志行。[moby/moby#39038](https://github.com/moby/moby/pull/39038)

### 已知问题
* 升级过程有重要变更，如果未正确遵循，可能影响 Swarm 上运行应用的可用性。这些约束影响从任何早于 18.09 的版本升级到 18.09 或更高版本的情况。

## 18.09.6
2019-05-06

### 构建器
* 修复 `DOCKER_BUILDKIT=1` 时 `COPY` 和 `ADD` 多个 `<src>` 不会失效缓存的问题。[moby/moby#38964](https://github.com/moby/moby/issues/38964)

### 网络
* 清理关闭的 agent 的集群提供者。[docker/libnetwork#2354](https://github.com/docker/libnetwork/pull/2354)
* Windows：现在如果用户未指定主机端口，将选择随机主机端口。[docker/libnetwork#2369](https://github.com/docker/libnetwork/pull/2369)

### 已知问题
* 升级过程有重要变更，如果未正确遵循，可能影响 Swarm 上运行应用的可用性。这些约束影响从任何早于 18.09 的版本升级到 18.09 或更高版本的情况。

## 18.09.5

2019-04-11

### 构建器

* 修复 `DOCKER_BUILDKIT=1 docker build --squash ..`。[docker/engine#176](https://github.com/docker/engine/pull/176)

### 客户端

* 修复 tty 初始大小错误。[docker/cli#1775](https://github.com/docker/cli/pull/1775)
* 修复 dial-stdio goroutine 泄漏。[docker/cli#1795](https://github.com/docker/cli/pull/1795)
* 修复堆栈信息器的选择器以跟踪部署。[docker/cli#1794](https://github.com/docker/cli/pull/1794)

### 网络

* 修复 `network=host` 在使用 `systemd-resolved` 时使用错误的 `resolv.conf`。[docker/engine#180](https://github.com/docker/engine/pull/180)
* 修复 Windows ARP 条目在负载下随机损坏的问题。[docker/engine#192](https://github.com/docker/engine/pull/192)

### 运行时
* 现在将具有重启策略的停止容器显示为 `Restarting`。[docker/engine#181](https://github.com/docker/engine/pull/181)
* 现在对 exec 使用原始进程规范。[docker/engine#178](https://github.com/docker/engine/pull/178)

### Swarm 模式

* 修复删除节点时任务资源泄漏的问题。[docker/engine#185](https://github.com/docker/engine/pull/185)

### 已知问题

* 升级过程有重要变更，如果未正确遵循，可能影响 Swarm 上运行应用的可用性。这些约束影响从任何早于 18.09 的版本升级到 18.09 或更高版本的情况。

## 18.09.4

 2019-03-28

### 构建器

* 通过添加对 `git ref` 的验证以避免被误解释为标志，修复 [CVE-2019-13139](https://nvd.nist.gov/vuln/detail/CVE-2019-13139)。[moby/moby#38944](https://github.com/moby/moby/pull/38944)

### 运行时

* 修复 `docker cp` 对文件名超过 100 字符的错误。[moby/moby#38634](https://github.com/moby/moby/pull/38634)
* 修复 `layer/layer_store` 以确保 `NewInputTarStream` 资源被释放。[moby/moby#38413](https://github.com/moby/moby/pull/38413)
* 增加 `GetConfigs` 的 GRPC 限制。[moby/moby#38800](https://github.com/moby/moby/pull/38800)
* 更新 `containerd` 到 1.2.5。[docker/engine#173](https://github.com/docker/engine/pull/173)

### Swarm 模式
* 修复加入 Swarm 时的空指针异常。[moby/moby#38618](https://github.com/moby/moby/issues/38618)
* 修复设置了 http 代理时 Swarm 节点无法作为主节点加入的问题。[moby/moby#36951]

### 已知问题
* 升级过程有重要变更，如果未正确遵循，可能影响 Swarm 上运行应用的可用性。这些约束影响从任何早于 18.09 的版本升级到 18.09 或更高版本的情况。

## 18.09.3

2019-02-28

### 网络修复
* Windows：现在避免网络 ID 重新生成以防止网络引用损坏。[docker/engine#149](https://github.com/docker/engine/pull/149)
* Windows：修复指定网络时独立容器的 `- restart always` 标志不工作的问题。（docker/escalation#1037）
* 修复从网络数据库获取 IPAM 状态的问题，如果管理器未附加到覆盖网络。（docker/escalation#1049）

### 运行时修复和更新

* 更新到 Go 版本 1.10.8。
* 修改了容器名称生成器中的名称。[docker/engine#159](https://github.com/docker/engine/pull/159)
* 复制现有文件夹时，如果目标文件系统不支持 xattr，则忽略 xattr 设置错误。[docker/engine#135](https://github.com/docker/engine/pull/135)
* Graphdriver：修复未检测到 "character-device" 位时 "device" 模式的问题。[docker/engine#160](https://github.com/docker/engine/pull/160)
* 修复连接 containerd 失败时的空指针解引用。[docker/engine#162](https://github.com/docker/engine/pull/162)
* 启动失败时删除陈旧的 containerd 对象。[docker/engine#154](https://github.com/docker/engine/pull/154)

### 已知问题
* 升级过程有重要变更，如果未正确遵循，可能影响 Swarm 上运行应用的可用性。这些约束影响从任何早于 18.09 的版本升级到 18.09 或更高版本的情况。

## 18.09.2

2019-02-11

### 安全修复
* 更新 `runc` 以解决允许特制容器获取主机管理员权限的关键漏洞。[CVE-2019-5736](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-5736)
* 使用 3.13 内核的 Ubuntu 14.04 用户需要升级到支持的 Ubuntu 4.x 内核

更多信息，请[参考 Docker 博客文章](https://blog.docker.com/2019/02/docker-security-update-cve-2018-5736-and-container-security-best-practices/)。

### 已知问题
* 升级过程有重要变更，如果未正确遵循，可能影响 Swarm 上运行应用的可用性。这些约束影响从任何早于 18.09 的版本升级到 18.09 或更高版本的情况。

## 18.09.1

2019-01-09

#### 关于此版本的重要说明

在 Docker 18.09 之前的版本中，containerd 由 Docker 引擎守护进程管理。在 Docker Engine 18.09 中，containerd 由 systemd 管理。由于 containerd 由 systemd 管理，任何更改挂载设置的 `docker.service` systemd 配置（例如，`MountFlags=slave`）都会破坏 Docker Engine 守护进程和 containerd 之间的交互，您将无法启动容器。

运行以下命令获取 `docker.service` 的 `MountFlags` 属性的当前值：

```console
$ sudo systemctl show --property=MountFlags docker.service
MountFlags=
```

如果此命令为 `MountFlags` 打印非空值，请更新您的配置并重启 docker 服务。

### 安全修复
* 升级 Go 语言到 1.10.6 以解决 [CVE-2018-16873](https://nvd.nist.gov/vuln/detail/CVE-2018-16873)、[CVE-2018-16874](https://nvd.nist.gov/vuln/detail/CVE-2018-16874) 和 [CVE-2018-16875](https://nvd.nist.gov/vuln/detail/CVE-2018-16875)。
* 修复授权插件的 0 长度内容和路径验证。
* 添加 `/proc/asound` 到屏蔽路径 [docker/engine#126](https://github.com/docker/engine/pull/126)

### 改进
* 更新到 BuildKit 0.3.3 [docker/engine#122](https://github.com/docker/engine/pull/122)
* 更新到 containerd 1.2.2 [docker/engine#144](https://github.com/docker/engine/pull/144)
* 为已弃用的传统 overlay 和 devicemapper 存储驱动程序提供额外警告 [docker/engine#85](https://github.com/docker/engine/pull/85)
* prune：在构建缓存清理之前执行镜像清理 [docker/cli#1532](https://github.com/docker/cli/pull/1532)
* 为实验性 CLI 命令（manifest）添加 bash 补全 [docker/cli#1542](https://github.com/docker/cli/pull/1542)
* Windows：允许在 Windows 10 上使用进程隔离 [docker/engine#81](https://github.com/docker/engine/pull/81)

### 修复
* 在 RHEL/CentOS 上禁用 runc 中的 kmem 计费（docker/escalation#614, docker/escalation#692）[docker/engine#121](https://github.com/docker/engine/pull/121)
* 修复低效的网络配置 [docker/engine#123](https://github.com/docker/engine/pull/123)
* 修复 docker system prune 不接受 until 过滤器 [docker/engine#122](https://github.com/docker/engine/pull/122)
* 避免在 `containerd` 中设置未认证凭据 [docker/engine#122](https://github.com/docker/engine/pull/122)
* 修复 Debian 上的 iptables 兼容性 [docker/engine#107](https://github.com/docker/engine/pull/107)
* 修复为 docker host 设置