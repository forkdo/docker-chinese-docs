---
title: Docker Engine 17.12 发布说明
linkTitle: Engine v17.12
toc_min: 1
toc_max: 2
---

## 17.12.1-ce
2018-02-27

### 客户端
- 修复 `node-generic-resource` 拼写错误 [moby/moby#35970](https://github.com/moby/moby/pull/35970) 和 [moby/moby#36125](https://github.com/moby/moby/pull/36125)
* 在堆栈部署配置创建/更新时从守护进程返回错误 [docker/cli#757](https://github.com/docker/cli/pull/757)

### 日志
- awslogs：修复大日志的批处理大小计算 [moby/moby#35726](https://github.com/moby/moby/pull/35726)
* 在 splunk 日志驱动中支持代理 [moby/moby#36220](https://github.com/moby/moby/pull/36220)

### 网络
- 修复从 17.09 升级到 17.12 时的入口网络 [moby/moby#36003](https://github.com/moby/moby/pull/36003)
* 为部分覆盖 ID 添加详细信息 [moby/moby#35989](https://github.com/moby/moby/pull/35989)
- 修复启用 live-restore 时 IPv6 网络被取消配置的问题 [docker/libnetwork#2043](https://github.com/docker/libnetwork/pull/2043)
- 修复 watchMiss 线程上下文 [docker/libnetwork#2051](https://github.com/docker/libnetwork/pull/2051)

### 打包
- 在 docker.service 中设置 TasksMax [docker/docker-ce-packaging#78](https://github.com/docker/docker-ce-packaging/pull/78)

### 运行时
* 将 Golang 升级到 1.9.4
* 将 containerd 升级到 1.0.1
- 修复 dockerd 在 containerd 重启后无法重新连接的问题 [moby/moby#36173](https://github.com/moby/moby/pull/36173)
- 修复 containerd 事件被处理两次的问题 [moby/moby#35891](https://github.com/moby/moby/issues/35891)
- 修复 vfs 图形驱动因文件系统配额设置失败而无法初始化的问题 [moby/moby#35827](https://github.com/moby/moby/pull/35827)
- 修复健康检查未使用容器工作目录的回归问题 [moby/moby#35845](https://github.com/moby/moby/pull/35845)
- 在 containerd 1.0 中支持 `DOCKER_RAMDISK` [moby/moby#35957](https://github.com/moby/moby/pull/35957)
- 更新 runc 以修复启动和执行时的挂起问题 [moby/moby#36097](https://github.com/moby/moby/pull/36097)
- Windows：更新 Microsoft/hcsshim @v.0.6.8 以部分修复导入层失败问题 [moby/moby#35924](https://github.com/moby/moby/pull/35924)
* 不要将图形驱动器主目录设为私有挂载 [moby/moby#36047](https://github.com/moby/moby/pull/36047)
* 对来自守护进程根目录的挂载使用 rslave 传播 [moby/moby#36055](https://github.com/moby/moby/pull/36055)
* 将守护进程根目录设置为使用共享挂载传播 [moby/moby#36096](https://github.com/moby/moby/pull/36096)
* 验证容器启动时挂载路径是否存在，而不仅仅是在创建期间 [moby/moby#35833](https://github.com/moby/moby/pull/35833)
* 在 TaskState 中添加 `REMOVE` 和 `ORPHANED` [moby/moby#36146](https://github.com/moby/moby/pull/36146)
- 修复网络检查在 swarm 范围内不显示网络创建时间的问题 [moby/moby#36095](https://github.com/moby/moby/pull/36095)
* 容器释放时清空其读写层 [moby/moby#36130](https://github.com/moby/moby/pull/36160) 和 [moby/moby#36343](https://github.com/moby/moby/pull/36242)

### Swarm
* 从 swarm 模式中移除 watchMiss [docker/libnetwork#2047](https://github.com/docker/libnetwork/pull/2047)

### 已知问题
* 健康检查不再使用容器的工作目录 [moby/moby#35843](https://github.com/moby/moby/issues/35843)
* 堆栈部署配置中客户端未返回错误 [moby/moby#757](https://github.com/docker/cli/pull/757)
* Docker 在使用 systemd 选项时无法使用内存限制 [moby/moby#35123](https://github.com/moby/moby/issues/35123)

## 17.12.0-ce
2017-12-27

### 已知问题
* AWS 日志批处理大小计算 [moby/moby#35726](https://github.com/moby/moby/pull/35726)
* 健康检查不再使用容器的工作目录 [moby/moby#35843](https://github.com/moby/moby/issues/35843)
* 堆栈部署配置中客户端未返回错误 [moby/moby#757](https://github.com/docker/cli/pull/757)
* 项目配额失败时守护进程中止 [moby/moby#35827](https://github.com/moby/moby/pull/35827)
* Docker 在使用 systemd 选项时无法使用内存限制 [moby/moby#35123](https://github.com/moby/moby/issues/35123)

### 构建器

- 修复断开符号链接的构建缓存哈希 [moby/moby#34271](https://github.com/moby/moby/pull/34271)
- 修复长流同步 [moby/moby#35404](https://github.com/moby/moby/pull/35404)
- 修复 Dockerfile 解析器在长令牌时静默失败的问题 [moby/moby#35429](https://github.com/moby/moby/pull/35429)

### 客户端

* 移除 cli/compose 中的 secret/config 重复 [docker/cli#671](https://github.com/docker/cli/pull/671)
* 为 `docker trust sign` 添加 `--local` 标志 [docker/cli#575](https://github.com/docker/cli/pull/575)
* 添加 `docker trust inspect` [docker/cli#694](https://github.com/docker/cli/pull/694)
+ 为 secrets 和 configs 添加 `name` 字段以允许在 Compose 文件中插值 [docker/cli#668](https://github.com/docker/cli/pull/668)
+ 添加 `--isolation` 以设置 swarm 服务隔离模式 [docker/cli#426](https://github.com/docker/cli/pull/426)
* 移除已弃用的 "daemon" 子命令 [docker/cli#689](https://github.com/docker/cli/pull/689)
- 修复 `rmi -f` 在遇到意外错误时的行为 [docker/cli#654](https://github.com/docker/cli/pull/654)
* 在服务创建中集成通用资源 [docker/cli#429](https://github.com/docker/cli/pull/429)
- 修复堆栈中的外部网络 [docker/cli#743](https://github.com/docker/cli/pull/743)
* 移除对通过 image shortid 引用镜像的支持 [docker/cli#753](https://github.com/docker/cli/pull/753) 和 [moby/moby#35790](https://github.com/moby/moby/pull/35790)
* 对 containerd 使用 commit-sha 而不是 tag [moby/moby#35770](https://github.com/moby/moby/pull/35770)

### 文档

* 更新 1.35 版本的 API 版本历史 [moby/moby#35724](https://github.com/moby/moby/pull/35724)

### 日志

* Logentries 驱动 line-only=true []byte 输出修复 [moby/moby#35612](https://github.com/moby/moby/pull/35612)
* Logentries line-only logopt 修复以保持向后兼容性 [moby/moby#35628](https://github.com/moby/moby/pull/35628)
+ 为 docker logs 添加 `--until` 标志 [moby/moby#32914](https://github.com/moby/moby/pull/32914)
+ 在 Windows 构建中添加 gelf 日志驱动插件 [moby/moby#35073](https://github.com/moby/moby/pull/35073)
* 在 splunk 批处理发送上设置超时 [moby/moby#35496](https://github.com/moby/moby/pull/35496)
* 更新 Graylog2/go-gelf [moby/moby#35765](https://github.com/moby/moby/pull/35765)

### 网络

* 将负载均衡器沙箱创建/删除移至 libnetwork [moby/moby#35422](https://github.com/moby/moby/pull/35422)
* 仅对容器元数据内的网络文件进行 chown [moby/moby#34224](https://github.com/moby/moby/pull/34224)
* 在 FindNetwork 中恢复错误类型 [moby/moby#35634](https://github.com/moby/moby/pull/35634)
- 修复 NetworkConnect 的 MIME 类型 [moby/moby#35542](https://github.com/moby/moby/pull/35542)
+ 添加对持久化 Windows 网络驱动特定选项的支持 [moby/moby#35563](https://github.com/moby/moby/pull/35563)
- 修复 netlink 套接字超时和 watchmiss 泄漏 [moby/moby#35677](https://github.com/moby/moby/pull/35677)
+ 添加用于网络诊断的新守护进程配置 [moby/moby#35677](https://github.com/moby/moby/pull/35677)
- 清理节点管理逻辑 [docker/libnetwork#2036](https://github.com/docker/libnetwork/pull/2036)
- 在端点恢复时分配 VIP [docker/swarmkit#2474](https://github.com/docker/swarmkit/pull/2474)

### 运行时

* 更新到 containerd v1.0.0 [moby/moby#35707](https://github.com/moby/moby/pull/35707)
* 让 VFS 图形驱动使用加速的内核级复制 [moby/moby#35537](https://github.com/moby/moby/pull/35537)
* 引入 `workingdir` 选项用于 docker exec [moby/moby#35661](https://github.com/moby/moby/pull/35661)
* 将 Go 升级到 1.9.2 [moby/moby#33892](https://github.com/moby/moby/pull/33892) [docker/cli#716](https://github.com/docker/cli/pull/716)
* 使用 `--readonly` 标志时 `/dev` 不应为只读 [moby/moby#35344](https://github.com/moby/moby/pull/35344)
+ 添加自定义构建时 Graphdrivers 优先级列表 [moby/moby#35522](https://github.com/moby/moby/pull/35522)
* LCOW：CLI 更改以添加平台标志 - pull、run、create 和 build [docker/cli#474](https://github.com/docker/cli/pull/474)
* 修复 Windows 上 `docker exec` 的宽度/高度 [moby/moby#35631](https://github.com/moby/moby/pull/35631)
* 在 4.0 之前内核上检测 overlay2 支持 [moby/moby#35527](https://github.com/moby/moby/pull/35527)
* Devicemapper：卸载后移除容器根文件系统挂载路径 [moby/moby#34573](https://github.com/moby/moby/pull/34573)
* 禁止在 NFS 上使用 overlay/overlay2 [moby/moby#35483](https://github.com/moby/moby/pull/35483)
- 修复插件设置期间的潜在 panic [moby/moby#35632](https://github.com/moby/moby/pull/35632)
- 修复容器上的一些锁定问题 [moby/moby#35501](https://github.com/moby/moby/pull/35501)
- 修复插件引用计数的一些问题 [moby/moby#35265](https://github.com/moby/moby/pull/35265)
+ 在 ProcessEvent 中添加缺失的锁 [moby/moby#35516](https://github.com/moby/moby/pull/35516)
+ 添加 vfs 配额支持 [moby/moby#35231](https://github.com/moby/moby/pull/35231)
* 在之前的图形驱动检测中跳过空目录 [moby/moby#35528](https://github.com/moby/moby/pull/35528)
* 在用户命名空间中运行时跳过 xfs 配额测试 [moby/moby#35526](https://github.com/moby/moby/pull/35526)
+ 添加 SubSecondPrecision 到配置选项 [moby/moby#35529](https://github.com/moby/moby/pull/35529)
* 更新 fsnotify 以修复移除 watch 时的死锁 [moby/moby#35453](https://github.com/moby/moby/pull/35453)
- 修复使用 `--tmpfs /dev/shm` 时的"重复挂载点"问题 [moby/moby#35467](https://github.com/moby/moby/pull/35467)
- 修复用户 `/dev/shm` 挂载的 tmpfs-size 大小限制 [moby/moby#35316](https://github.com/moby/moby/pull/35316)
- 修复 overlayfs 和 v4.13+ 内核下的 EBUSY 错误 [moby/moby#34948](https://github.com/moby/moby/pull/34948)
* 容器：保护健康监控通道 [moby/moby#35482](https://github.com/moby/moby/pull/35482)
* 容器：使用互斥锁保护健康状态 [moby/moby#35517](https://github.com/moby/moby/pull/35517)
* 容器：更新实时资源 [moby/moby#33731](https://github.com/moby/moby/pull/33731)
* 当卷仅在远程存在时创建标签 [moby/moby#34896](https://github.com/moby/moby/pull/34896)
- 修复容器/exec 状态泄漏 [moby/moby#35484](https://github.com/moby/moby/pull/35484)
* 禁止使用传统（v1）注册表 [moby/moby#35751](https://github.com/moby/moby/pull/35751) 和 [docker/cli#747](https://github.com/docker/cli/pull/747)
- Windows：修复针对构建器缓存的不区分大小写的文件名匹配 [moby/moby#35793](https://github.com/moby/moby/pull/35793)
- 修复进程处理和错误检查中的竞态条件 [moby/moby#35809