---
title: Docker Engine 17.04 发行说明
linkTitle: Engine v17.04
toc_min: 1
toc_max: 2
---

## 17.04.0-ce
2017-04-05

### Builder

* 禁用构建容器的日志记录 [#29552](https://github.com/docker/docker/pull/29552)
* 修复 `.dockerignore` 中使用 `**/` 的问题 [#29043](https://github.com/docker/docker/pull/29043)

### Client

+ 按名称对 `docker stack ls` 进行排序 [#31085](https://github.com/docker/docker/pull/31085)
+ 用于指定绑定挂载一致性的标志 [#31047](https://github.com/docker/docker/pull/31047)
* docker CLI --help 的输出现在会根据终端宽度自动换行 [#28751](https://github.com/docker/docker/pull/28751)
* 在 `docker ps` 中隐藏镜像摘要 [#30848](https://github.com/docker/docker/pull/30848)
* 隐藏与 Windows 相关的命令选项 [#30788](https://github.com/docker/docker/pull/30788)
* 修复 `docker plugin install` 提示，使其接受 "enter" 键作为默认的 "N" 选项 [#30769](https://github.com/docker/docker/pull/30769)
+ 为 Go 模板添加 `truncate` 函数 [#30484](https://github.com/docker/docker/pull/30484)
* 在 `stack deploy` 中支持扩展的端口语法 [#30476](https://github.com/docker/docker/pull/30476)
* 在 `stack deploy` 中支持扩展的挂载语法 [#30597](https://github.com/docker/docker/pull/30597) [#31795](https://github.com/docker/docker/pull/31795)
+ 为 `docker build` 添加 `--add-host` [#30383](https://github.com/docker/docker/pull/30383)
+ 为 `docker network ls --format` 添加 `.CreatedAt` 占位符 [#29900](https://github.com/docker/docker/pull/29900)
* 更新 `--secret-rm` 和 `--secret-add` 的顺序 [#29802](https://github.com/docker/docker/pull/29802)
+ 为 `docker plugin ls` 添加 `--filter enabled=true` [#28627](https://github.com/docker/docker/pull/28627)
+ 为 `docker service ls` 添加 `--format` [#28199](https://github.com/docker/docker/pull/28199)
+ 为 `docker ps --filter` 添加 `publish` 和 `expose` 过滤器 [#27557](https://github.com/docker/docker/pull/27557)
* 支持在 `docker service ps` 中使用多个服务 ID [#25234](https://github.com/docker/docker/pull/25234)
+ 允许使用 `--availability=drain` 加入 swarm [#24993](https://github.com/docker/docker/pull/24993)
* 当启用 AppArmor 且未定义其他配置文件时，`docker inspect` 现在显示 "docker-default" [#27083](https://github.com/docker/docker/pull/27083)

### Logging

+ 为容器日志实现可选的环形缓冲区 [#28762](https://github.com/docker/docker/pull/28762)
+ 为 awslogs (CloudWatch) 添加 `--log-opt awslogs-create-group=<true|false>`，以支持按需创建日志组 [#29504](https://github.com/docker/docker/pull/29504)
- 修复在使用 "static" 二进制文件时，gcplogs 日志驱动程序导致的段错误 [#29478](https://github.com/docker/docker/pull/29478)

### Networking

* 在 `docker network connect` 中检查参数 `--ip`、`--ip6` 和 `--link-local-ip` [#30807](https://github.com/docker/docker/pull/30807)
+ 添加对 `dns-search` 的支持 [#30117](https://github.com/docker/docker/pull/30117)
+ 为 `docker network inspect` 添加 `--verbose` 选项，以显示来自所有 swarm 节点的任务详情 [#31710](https://github.com/docker/docker/pull/31710)
* 在加入集群时清除陈旧的数据路径加密状态 [docker/libnetwork#1354](https://github.com/docker/libnetwork/pull/1354)
+ 确保 iptables 初始化只发生一次 [docker/libnetwork#1676](https://github.com/docker/libnetwork/pull/1676)
* 修复 iptables 过滤器规则的错误顺序 [docker/libnetwork#961](https://github.com/docker/libnetwork/pull/961)
+ 在可附加网络上为服务记录添加匿名容器别名 [docker/libnetwork#1651](https://github.com/docker/libnetwork/pull/1651)
+ 支持 `com.docker.network.container_iface_prefix` 驱动程序标签 [docker/libnetwork#1667](https://github.com/docker/libnetwork/pull/1667)
+ 通过省略未使用的网络详情来提高网络列表性能 [#30673](https://github.com/docker/docker/pull/30673)

### Runtime

* 在未设置 live-restore 的情况下恢复时处理已暂停的容器 [#31704](https://github.com/docker/docker/pull/31704)
- 不允许在 Dockerfile 的健康检查选项中使用亚秒级时间 [#31177](https://github.com/docker/docker/pull/31177)
* 在 `secret update` 中支持名称和 ID 前缀 [#30856](https://github.com/docker/docker/pull/30856)
* 为 websocket attach 端点使用二进制帧 [#30460](https://github.com/docker/docker/pull/30460)
* 修复 Linux 挂载调用未应用传播类型更改的问题 [#30416](https://github.com/docker/docker/pull/30416)
* 修复在失败的 `exec -i` 上 ExecIds 泄漏的问题 [#30340](https://github.com/docker/docker/pull/30340)
* 如果 `danglingOnly=true`，则修剪已命名但未标记的镜像 [#30330](https://github.com/docker/docker/pull/30330)
+ 添加守护程序标志，将 `no_new_priv` 设置为非特权容器的默认值 [#29984](https://github.com/docker/docker/pull/29984)
+ 添加守护程序选项 `--default-shm-size` [#29692](https://github.com/docker/docker/pull/29692)
+ 支持注册表镜像配置重载 [#29650](https://github.com/docker/docker/pull/29650)
- 在构建镜像时忽略守护程序日志配置 [#29552](https://github.com/docker/docker/pull/29552)
* 将密钥名称或 ID 前缀的解析从客户端移到守护程序 [#29218](https://github.com/docker/docker/pull/29218)
+ 允许在容器创建/运行时向 `cgroup devices.allow` 添加规则 [#22563](https://github.com/docker/docker/pull/22563)
- 修复在运行 `systemd daemon-reload` 时 `cpu.cfs_quota_us` 被重置的问题 [#31736](https://github.com/docker/docker/pull/31736)

### Swarm Mode

+ 拓扑感知调度 [#30725](https://github.com/docker/docker/pull/30725)
+ 故障时自动服务回滚 [#31108](https://github.com/docker/docker/pull/31108)
+ 同一节点上的工作节点和管理节点现在通过 UNIX 套接字连接 [docker/swarmkit#1828](https://github.com/docker/swarmkit/pull/1828), [docker/swarmkit#1850](https://github.com/docker/swarmkit/pull/1850), [docker/swarmkit#1851](https://github.com/docker/swarmkit/pull/1851)
* 改进 raft 传输包 [docker/swarmkit#1748](https://github.com/docker/swarmkit/pull/1748)
* 在降级/移除时不会自动关闭管理节点 [docker/swarmkit#1829](https://github.com/docker/swarmkit/pull/1829)
* 使用 TransferLeadership 使领导者降级更安全 [docker/swarmkit#1939](https://github.com/docker/swarmkit/pull/1939)
* 减少默认监控周期 [docker/swarmkit#1967](https://github.com/docker/swarmkit/pull/1967)
+ 添加服务日志格式化 [#31672](https://github.com/docker/docker/pull/31672)
* 修复服务日志 API 以能够指定流 [#31313](https://github.com/docker/docker/pull/31313)
+ 为 `service create` 和 `service update` 添加 `--stop-signal` [#30754](https://github.com/docker/docker/pull/30754)
+ 为 `service create` 和 `service update` 添加 `--read-only` [#30162](https://github.com/docker/docker/pull/30162)
+ 与注册表通信后更新上下文 [#31586](https://github.com/docker/docker/pull/31586)
+ (实验性) 为 `docker service logs` 添加 `--tail` 和 `--since` 选项 [#31500](https://github.com/docker/docker/pull/31500)
+ (实验性) 为 `docker service logs` 添加 `--no-task-ids` 和 `--no-trunc` 选项 [#31672](https://github.com/docker/docker/pull/31672)

### Windows

* 在非 Windows 守护程序上阻止拉取 Windows 镜像 [#29001](https://github.com/docker/docker/pull/29001)