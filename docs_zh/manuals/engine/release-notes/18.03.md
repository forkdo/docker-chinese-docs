---
title: Docker Engine 18.03 发行说明
linkTitle: Engine v18.03
toc_min: 1
toc_max: 2
---

## 18.03.1-ce
2018-04-26

### 客户端

- 修复使用 networks 合并 compose 文件时的错误 [docker/cli#983](https://github.com/docker/cli/pull/983)
* 修复 docker stack deploy 在使用 `--force` 更新服务后重新部署服务的问题 [docker/cli#963](https://github.com/docker/cli/pull/963)
* 修复 docker version 输出对齐问题 [docker/cli#965](https://github.com/docker/cli/pull/965)

### 运行时

- 修复 AppArmor 配置文件未应用到 `docker exec` 进程的问题 [moby/moby#36466](https://github.com/moby/moby/pull/36466)
- 不对插件挂载切片进行排序 [moby/moby#36711](https://github.com/moby/moby/pull/36711)
- 守护进程/集群：处理配置期间的部分附加条目 [moby/moby#36769](https://github.com/moby/moby/pull/36769)
* 将 Go 升级到 1.9.5 [moby/moby#36779](https://github.com/moby/moby/pull/36779) [docker/cli#986](https://github.com/docker/cli/pull/986)
- 守护进程/统计：更健壮的 CPU 采样 [moby/moby#36519](https://github.com/moby/moby/pull/36519)
* Containerd：更新到 1.0.3 版本 [moby/moby#36749](https://github.com/moby/moby/pull/36749)
- 修复写入失败时 Windows 层泄漏问题 [moby/moby#36728](https://github.com/moby/moby/pull/36728)
* 不要使容器挂载不可绑定 [moby/moby#36768](https://github.com/moby/moby/pull/36768)
- 修复守护进程重启后容器导出时守护进程崩溃的问题 [moby/moby/36586](https://github.com/moby/moby/pull/36586)
- 修复授权错误时摘要缓存被删除的问题 [moby/moby#36509](https://github.com/moby/moby/pull/36509)
- 确保插件容器在失败时被移除 [moby/moby#36715](https://github.com/moby/moby/pull/36715)
- 复制：避免在使用 authz 插件时使用所有系统内存 [moby/moby#36595](https://github.com/moby/moby/pull/36595)
- 放宽一些 libcontainerd 客户端锁定 [moby/moby#36848](https://github.com/moby/moby/pull/36848)
- 更新 `hcsshim` 到 v0.6.10 以解决 [CVE-2018-8115](https://portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2018-8115)

### Swarm 模式

* 将 raft 选举时间增加到心跳时间的 10 倍 [moby/moby#36672](https://github.com/moby/moby/pull/36672)

### 网络

* 优雅地从服务中移除 LB 端点 [docker/libnetwork#2112](https://github.com/docker/libnetwork/pull/2112)
* 在 ServFail 时重试其他外部 DNS 服务器 [docker/libnetwork#2121](https://github.com/docker/libnetwork/pull/2121)
* 提升桥接网络隔离规则的可扩展性 [docker/libnetwork#2117](https://github.com/docker/libnetwork/pull/2117)
* 允许更大的预设属性值，不覆盖 [docker/libnetwork#2124](https://github.com/docker/libnetwork/pull/2124)
* 防止在调用 `changeNodeState` 时并发读写导致的崩溃 [docker/libnetwork#2136](https://github.com/docker/libnetwork/pull/2136)

## 18.03.0-ce
2018-03-21

### 构建器

* 切换到 -buildmode=pie [moby/moby#34369](https://github.com/moby/moby/pull/34369)
* 允许 Dockerfile 位于构建上下文之外 [docker/cli#886](https://github.com/docker/cli/pull/886)
* 构建器：修复从 tar 构建时的错误缓存命中 [moby/moby#36329](https://github.com/moby/moby/pull/36329)
- 修复多阶段构建中文件泄漏到其他镜像的问题 [moby/moby#36338](https://github.com/moby/moby/pull/36338)

### 客户端

* 简化 compose types.Config 的序列化 [docker/cli#895](https://github.com/docker/cli/pull/895)
+ 添加部署时对多个 composefile 的支持 [docker/cli#569](https://github.com/docker/cli/pull/569)
- 修复 Kubernetes stack 标志的错误 [docker/cli#831](https://github.com/docker/cli/pull/831)
- 修复 Kubernetes 的 stack 序列化 [docker/cli#890](https://github.com/docker/cli/pull/890)
- 修复并简化服务 env、mounts 和 labels 的 bash 补全 [docker/cli#682](https://github.com/docker/cli/pull/682)
- 修复 `docker ps` 的 `before` 和 `since` 过滤器 [moby/moby#35938](https://github.com/moby/moby/pull/35938)
- 修复 `--label-file` 的异常行为 [docker/cli#838](https://github.com/docker/cli/pull/838)
- 修复在不支持的平台上默认凭证存储的编译问题 [docker/cli#872](https://github.com/docker/cli/pull/872)
* 改进并修复镜像的 bash 补全 [docker/cli#717](https://github.com/docker/cli/pull/717)
+ 为 bind mount 添加空源检查 [docker/cli#824](https://github.com/docker/cli/pull/824)
- 修复客户端中环境变量的 TLS [moby/moby#36270](https://github.com/moby/moby/pull/36270)
* 当配置了注册表特定的凭证助手时，docker build 现在运行得更快 [docker/cli#840](https://github.com/docker/cli/pull/840)
* 使用 `disable`、`enable`、`install` 和 `remove` 更新事件过滤器的 zsh 补全 [docker/cli#372](https://github.com/docker/cli/pull/372)
* 当向检查调用传递空 id 时产生错误 [moby/moby#36144](https://github.com/moby/moby/pull/36144)
* 为 k8s 控制器序列化版本 [docker/cli#891](https://github.com/docker/cli/pull/891)
* 为与插件后端的 HTTP 客户端通信设置非零超时 [docker/cli#883](https://github.com/docker/cli/pull/883)
+ 为 --tls 选项添加 DOCKER_TLS 环境变量 [docker/cli#863](https://github.com/docker/cli/pull/863)
+ 为 secrets/configs 添加 --template-driver 选项 [docker/cli#896](https://github.com/docker/cli/pull/896)
+ 将 `docker trust` 命令移出实验性功能 [docker/cli#934](https://github.com/docker/cli/pull/934) [docker/cli#935](https://github.com/docker/cli/pull/935) [docker/cli#944](https://github.com/docker/cli/pull/944)

### 日志

* AWS 日志 - 不向最大大小事件添加新行 [moby/moby#36078](https://github.com/moby/moby/pull/36078)
* 在加载插件后移动日志验证器逻辑 [moby/moby#36306](https://github.com/moby/moby/pull/36306)
* 在 Splunk 日志驱动中支持代理 [moby/moby#36220](https://github.com/moby/moby/pull/36220)
- 修复空日志的 tail 日志 [moby/moby#36305](https://github.com/moby/moby/pull/36305)

### 网络

* Libnetwork 重新打包 [moby/moby#36137](https://github.com/moby/moby/pull/36137)
- 修复 Memberlist 重新打包时退出时的死锁 [docker/libnetwork#2040](https://github.com/docker/libnetwork/pull/2040)
* 修复用户指定的 ndots 选项 [docker/libnetwork#2065](https://github.com/docker/libnetwork/pull/2065)
- 修复在 Windows 上使用 ContainerID 而不是 SandboxID [docker/libnetwork#2010](https://github.com/docker/libnetwork/pull/2010)
* 验证 NetworkingConfig 以确保 EndpointSettings 不为 nil [moby/moby#36077](https://github.com/moby/moby/pull/36077)
- 修复 `DockerNetworkInternalMode` 问题 [moby/moby#36298](https://github.com/moby/moby/pull/36298)
- 修复可附加网络附加中的竞争 [moby/moby#36191](https://github.com/moby/moby/pull/36191)
- 修复 AArch64 上 `InspectNetwork` 的超时问题 [moby/moby#36257](https://github.com/moby/moby/pull/36257)
* 部分 overlay ID 缺少详细信息 [moby/moby#35989](https://github.com/moby/moby/pull/35989)
* 更新 `FindNetwork` 以解决网络名称重复问题 [moby/moby#30897](https://github.com/moby/moby/pull/30897)
* 禁止附加 ingress 网络 [docker/swarmkit#2523](https://github.com/docker/swarmkit/pull/2523)
- 防止隐式移除 ingress 网络 [moby/moby#36538](https://github.com/moby/moby/pull/36538)
- 修复 Windows 上的陈旧 HNS 端点 [moby/moby#36603](https://github.com/moby/moby/pull/36603)
- IPAM 修复重复 IP 地址问题 [docker/libnetwork#2104](https://github.com/docker/libnetwork/pull/2104) [docker/libnetwork#2105](https://github.com/docker/libnetwork/pull/2105)

### 运行时

* 启用 Windows 的 HotAdd [moby/moby#35414](https://github.com/moby/moby/pull/35414)
* LCOW：Graphdriver 修复 hotRemoveVHDs 中的死锁 [moby/moby#36114](https://github.com/moby/moby/pull/36114)
* LCOW：如果只有一层则使用常规挂载 [moby/moby#36052](https://github.com/moby/moby/pull/36052)
* 移除临时环境变量 LCOW_API_PLATFORM_IF_OMITTED [moby/moby#36269](https://github.com/moby/moby/pull/36269)
* 重新打包 Microsoft/opengcs @ v0.3.6 [moby/moby#36108](https://github.com/moby/moby/pull/36108)
- 修复 ExitCode 和 PID 不显示在 Task.Status.ContainerStatus 中的问题 [moby/moby#36150](https://github.com/moby/moby/pull/36150)
- 修复插件扫描器过深的问题 [moby/moby#36119](https://github.com/moby/moby/pull/36119)
* 不要将 graphdriver 主目录设为私有挂载 [moby/moby#36047](https://github.com/moby/moby/pull/36047)
* 不要在 zfs/btrfs 清理时递归卸载 [moby/moby#36237](https://github.com/moby/moby/pull/36237)
* 如果层不存在则不恢复镜像 [moby/moby#36304](https://github.com/moby/moby/pull/36304)
* 调整模板化配置/密钥的最小 API 版本 [moby/moby#36366](https://github.com/moby/moby/pull/36366)
* 将 containerd 升级到 1.0.2 (cfd04396dc68220d1cecbe686a6cc3aa5ce3667c) [moby/moby#36308](https://github.com/moby/moby/pull/36308)
* 将 Go 升级到 1.9.4 [moby/moby#36243](https://github.com/moby/moby/pull/36243)
* 确保守护进程根目录在关闭时被卸载 [moby/moby#36107](https://github.com/moby/moby/pull/36107)
* 将 runc 升级到 6c55f98695e902427906eed2c799e566e3d3dfb5 [moby/moby#36222](https://github.com/moby/moby/pull/36222)
- 修复守护进程重启时的容器清理 [moby/moby#36249](https://github.com/moby/moby/pull/36249)
* 支持 SCTP 端口映射（将 API 升级到 v1.37） [moby/moby#33922](https://github.com/moby/moby/pull/33922)
* 支持 SCTP 端口映射 [docker/cli#278](https://github.com/docker/cli/pull/278)
- 修复 ContainerConfig 中的 Volumes 属性定义 [moby/moby#35946](https://github.com/moby/moby/pull/35946)
* 升级 moby 和依赖项 [docker/cli#829](https://github.com/docker/cli/pull/829)
* C.RWLayer：使用前检查是否为 nil [moby/moby#36242](https://github.com/moby/moby/pull/36242)
+ 为 TaskState 添加 `REMOVE` 和 `ORPHANED` [moby/moby#36146](https://github.com/moby/moby/pull/36146)
- 使用 `IsErrNotFound` 和 `IsErrNotImplemented` 修复 `ContainerStatPath`、`CopyFromContainer` 和 `CopyToContainer` 方法的错误检测 [moby/moby#35979](https://github.com/moby/moby/pull/35979)
+ 为 integration/internal/container 添加辅助包 [moby/moby#36266](https://github.com/moby/moby/pull/36266)
+ 添加规范导入路径 [moby/moby#36194](https://github.com/moby/moby/pull/36194)
+ 为集成添加/使用 container.Exec() [moby/moby#36326](https://github.com/moby/moby/pull/36326)
- 修复 "--node-generic-resource" 的单复数 [moby/moby#36125](https://github.com/moby/moby/pull/36125)
* Daemon.cleanupContainer：释放时将容器 RWLayer 置空 [moby/moby#36160](https://github.com/moby/moby/pull/36160)
* 守护进程：将 `--oom-kill-disable` 选项传递给 containerd [moby/moby#36201](https://github.com/moby/moby/pull/36201)
* 当存在绑定端口且网络模式为主机时显示警告消息 [moby/moby#3551